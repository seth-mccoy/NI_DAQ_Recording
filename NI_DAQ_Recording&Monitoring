import nidaqmx
import time
from timeit import default_timer as timer
import xlwt
from xlwt import Workbook
import datetime

sys=nidaqmx.system.System.local()
dev=sys.devices[1]
task=nidaqmx.Task('AcquireTemp')
task.ai_channels.add_ai_thrmcpl_chan(dev.name+'/ai0','Temp0',min_val = float(0),max_val = float(100))
task.timing.cfg_samp_clk_timing(50000, samps_per_chan=25000)
measurement={}
measurement['Temperature 0']=[]
measurement['Timestamp']=[]

init=timer()
previouslyStable=False
currentlyStable=False
powerAtTime1=timer()-init
outputHigh=False
measuring=False
measurementCounter=0
postMeasurementActive=False
preMeasurementActive=True
highHold=False
numSteps=1
step=0
wb = Workbook()
row=0
column=0
sheet1 = wb.add_sheet('Test Data2')
sheet1.write(row,column,'Timestamp')
column=column+1
sheet1.write(row,column,'Temperature')
wb.save('TestFile')

while True:
    ls=task.read()
    timestamp=timer()-init
    Temperature=ls
    Temperature!=0
    row=row+1
    if measuring:
        measurement['Timestamp'].append(timestamp)
        print('Timestamp = ' + timestamp)
        sheet1.write(row,column,timestamp)
        column=column+1
        measurement['Temperature'].append(ls[0])
        print('temperature = ' + ls[0])
        sheet1.write(row,column,ls[0])
        row=row+1
        column=0        
    elif False:
        pass

    else:
        pass
    